From 914a04e56921b95ce6d4a1faf446b8f2fb6d873b Mon Sep 17 00:00:00 2001
From: Mark Harfouche <mark.harfouche@gmail.com>
Date: Sat, 13 Dec 2025 14:49:25 -0500
Subject: [PATCH 6/8] Update mlmodel to newer absel

---
 .../NeuralNetwork/NeuralNetworkLayerValidator.cpp      |  2 +-
 mlmodel/src/Validation/PipelineValidator.cpp           |  6 +++---
 mlmodel/tools/enumgen.cpp                              | 10 +++++-----
 3 files changed, 9 insertions(+), 9 deletions(-)

diff --git a/mlmodel/src/Validation/NeuralNetwork/NeuralNetworkLayerValidator.cpp b/mlmodel/src/Validation/NeuralNetwork/NeuralNetworkLayerValidator.cpp
index a3f18b49..b9316511 100644
--- a/mlmodel/src/Validation/NeuralNetwork/NeuralNetworkLayerValidator.cpp
+++ b/mlmodel/src/Validation/NeuralNetwork/NeuralNetworkLayerValidator.cpp
@@ -2949,5 +2949,5 @@ Result NeuralNetworkSpecValidator::validateSliceBySizeLayer(const Specification:
 
 
 Result NeuralNetworkSpecValidator::validateFailUnknownType(const Specification::NeuralNetworkLayer& layer) {
-    return Result(ResultType::INVALID_MODEL_PARAMETERS, "Unsupported layer type (" + layer.GetTypeName() + ") for layer '" + layer.name() + "'.");
+    return Result(ResultType::INVALID_MODEL_PARAMETERS, "Unsupported layer type (" + std::string(layer.GetTypeName()) + ") for layer '" + std::string(layer.name()) + "'.");
 }
diff --git a/mlmodel/src/Validation/PipelineValidator.cpp b/mlmodel/src/Validation/PipelineValidator.cpp
index d28c3475..718f85ab 100644
--- a/mlmodel/src/Validation/PipelineValidator.cpp
+++ b/mlmodel/src/Validation/PipelineValidator.cpp
@@ -41,13 +41,13 @@ namespace CoreML {
 
                 if(it == typeTable.end()) {
                     return Result(ResultType::INVALID_MODEL_PARAMETERS,
-                                  ("Pipeline: the input '" + arg.name() + "' of model '" + model.description().GetTypeName()
+                                  ("Pipeline: the input '" + std::string(arg.name()) + "' of model '" + std::string(model.description().GetTypeName())
                                    + "' does not present in pipeline input or previous model."));
                 }
 
                 if(!CoreML::Specification::isEquivalent(arg, *(it->second))) {
                     return Result(ResultType::TYPE_MISMATCH,
-                                  ("Pipeline: the input '" + arg.name() + "' of model '" + model.description().GetTypeName()
+                                  ("Pipeline: the input '" + std::string(arg.name()) + "' of model '" + std::string(model.description().GetTypeName())
                                    + "' does not match the type previously specified by the pipeline input or the output of a previous model."
                                    + " For the second case, make sure the input and previous model's output has the matching name and shapes."));
                 }
@@ -79,7 +79,7 @@ namespace CoreML {
                               ("Type of pipeline output '" + output.name() + "' does not match type produced in pipeline input."));
             }
         }
-        
+
         if (spec.isupdatable()) {
             for (int modelIdx = 0; modelIdx < nModels - 1; modelIdx++) {
                 auto model = pipelineParams.models(modelIdx);
diff --git a/mlmodel/tools/enumgen.cpp b/mlmodel/tools/enumgen.cpp
index f6feb4b6..2b73bd24 100644
--- a/mlmodel/tools/enumgen.cpp
+++ b/mlmodel/tools/enumgen.cpp
@@ -1,4 +1,4 @@
-#include "../../deps/protobuf/src/google/protobuf/compiler/plugin.pb.h"
+#include <google/protobuf/compiler/plugin.pb.h>
 
 #include <iostream>
 #include <sstream>
@@ -10,23 +10,23 @@ using namespace google::protobuf::compiler;
 const char *INDENT = "    ";
 
 // extract the portion of filename before the first . character
-static std::string basename(const std::string& filename) {
+static std::string_view basename(const std::string_view& filename) {
   size_t dotPosition = filename.find('.');
   assert(dotPosition != std::string::npos);
   return filename.substr(0, dotPosition);
 }
 
 // make a filename like foo_enums.h from foo.proto
-static std::string makeExt(const std::string& filename) {
+static std::string makeExt(const std::string_view& filename) {
   std::stringstream result;
   result << basename(filename);
   result << "_enums.h";
   return result.str();
 }
 
-static std::string makeGuard(const std::string& filename) {
+static std::string makeGuard(const std::string_view& filename) {
   std::stringstream result;
-  std::string upperBasename = basename(filename);
+  std::string upperBasename = std::string(basename(filename));
   for (auto & c: upperBasename) c = std::toupper(c);
   result << "__" << upperBasename << "_ENUMS_H";
   return result.str();
-- 
2.51.0

